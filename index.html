<!doctype html>
<html>
<head>
  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.css" />
  <link rel="stylesheet" href="css/places.css">
  <!--[if lte IE 8]>
     <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.ie.css" />
  <![endif]-->
  <style type="text/css">
    body {
      padding: 0;
      margin: 0;
    }

    html, body, #PlacesYouCantGo {
      height: 100%;
    }

  </style>
  <script src="http://cdn.leafletjs.com/leaflet-0.5/leaflet.js"></script>
  <script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
<body>
  <div id="PlacesYouCantGo"></div>

  <div class="sidepanel">
      <div class="wrapper">
        <div class="context subheader">
          <p>map created by <a href="#">me</a></p>
        </div>
        <h1 id="headline"><i>"Top 10 Places You Cant Go"</i></h1>
        <div id="info">
            <p>
                Animated map made on the "Top 10 Places You Cant Go" list by JAMIE FRATER in 2010
            </p>
            <p class='source'>
                - <a href="http://listverse.com/2010/01/06/top-10-places-you-cant-go/" target="_blank">listverse.com</a>
            </p>
        </div>
        <div class="context footer">
        </div>
      </div>
      <div id="back-button">
        <a id="back">back</a></p>
      </div>
      <div id="next-button">
        <a id="next">next</a></p>
      </div>
    </div>


  <script>
    var map;
    var mapView = 0;
    var mapCenter;

    $('#next').click(function(){
      mapView= mapView+1;
      changeCenter(mapView);
      console.log('change to mapView '+ mapView)
    });

    $('#back').click(function(){

    });

    

    //base map
    var places = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
      maxZoom: 18,
      attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
    });

    //get geojson data on the map
    $.getJSON("./GeoJSON/places.geojson", function(data) {
      var geojson = L.geoJson(data, {
        onEachFeature: function (feature, layer) {
          layer.bindPopup('<b>'+feature.properties.name + '</b><br />' + feature.properties.text);
        }
      });
      map = L.map('PlacesYouCantGo').fitBounds(geojson.getBounds());
      places.addTo(map);
      geojson.addTo(map);
      map.setView(new L.LatLng(40.7, 16.2), 2);
    });
    //zoom a la siguiente localizacion 
    function changeCenter(mapView){
/*      $.ajax({
        url: './GeoJSON/places.geojson',
        async: false,
        dataType: 'json',
        success: function (data) {
          for (var i = data.features.length - 1; i >= 0; i--) {
            if (data.features[i].properties.top == mapView){
              console.log(data.features[i].geometry.coordinates[0]);
              mapCenter = data.features[i].geometry.coordinates[0]+','+data.features[i].geometry.coordinates[1];
              console.log('mapCenter '+mapCenter)
              return
            }
          };
        }
      });*/
      mapCenter= $.getJSON( "./GeoJSON/places.geojson", function( data ) {
            console.log(data.features[mapView].geometry.coordinates[0]);
            var center = data.features[i].geometry.coordinates[0]+','+data.features[i].geometry.coordinates[1];
            console.log('center '+center)
            return center
          }
      console.log('mapCenter: '+ mapCenter)
      map.panTo(new L.LatLng(mapCenter));
    }

  </script>
</body>
</html>